# Ask Expert - 4 Modes Visual Matrix & Flow

**Created:** November 6, 2025  
**Purpose:** Visual representation of the 4 Ask Expert modes and their current implementation flow

---

## ğŸ¯ 2Ã—2 Mode Matrix

```
                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                      â”‚          AGENT SELECTION STRATEGY                  â”‚
                      â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
                      â”‚       MANUAL         â”‚        AUTOMATIC            â”‚
                      â”‚   (User Selects)     â”‚    (AI Selects Best)        â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                     â”‚                      â”‚                             â”‚
â”‚   QUERY TYPE        â”‚   ğŸ¯ MODE 1          â”‚   âš¡ MODE 2                 â”‚
â”‚                     â”‚   Manual Expert      â”‚   Automatic Expert          â”‚
â”‚   SIMPLE            â”‚   Selection          â”‚   Selection                 â”‚
â”‚   One-Shot Query    â”‚                      â”‚                             â”‚
â”‚   (No Conversation) â”‚   "Quick Expert"     â”‚   "Smart Search"            â”‚
â”‚                     â”‚                      â”‚                             â”‚
â”‚   âœ“ Single question â”‚   ğŸ‘¤ User picks      â”‚   ğŸ¤– AI picks               â”‚
â”‚   âœ“ Fast answers    â”‚      expert          â”‚      expert                 â”‚
â”‚   âœ— No follow-ups   â”‚   ğŸ“š Agent-specific  â”‚   ğŸŒ Universal              â”‚
â”‚   âœ— No workflows    â”‚      knowledge       â”‚      knowledge              â”‚
â”‚                     â”‚   âš¡ 20-30 sec       â”‚   âš¡ 20-30 sec              â”‚
â”‚                     â”‚                      â”‚                             â”‚
â”‚                     â”‚   Example:           â”‚   Example:                  â”‚
â”‚                     â”‚   "What are FDA      â”‚   "Best practices           â”‚
â”‚                     â”‚    510(k) reqs?"     â”‚    for clinical trials?"    â”‚
â”‚                     â”‚    â†’ User selects    â”‚    â†’ AI selects             â”‚
â”‚                     â”‚      Regulatory      â”‚      Clinical Expert        â”‚
â”‚                     â”‚                      â”‚                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                     â”‚                      â”‚                             â”‚
â”‚   CONVERSATION TYPE â”‚   ğŸ¯ MODE 3          â”‚   ğŸ¼ MODE 4                 â”‚
â”‚                     â”‚   Manual Autonomous  â”‚   Automatic Autonomous      â”‚
â”‚   COMPLEX           â”‚                      â”‚                             â”‚
â”‚   Multi-Turn Chat   â”‚   "Expert Partner"   â”‚   "Expert Orchestra"        â”‚
â”‚   + Workflows       â”‚                      â”‚                             â”‚
â”‚                     â”‚   ğŸ‘¤ User picks      â”‚   ğŸ¤– AI picks &             â”‚
â”‚   âœ“ Multi-turn chat â”‚      expert          â”‚      switches               â”‚
â”‚   âœ“ Workflows       â”‚   ğŸ¤ Same expert     â”‚   ğŸ¼ Multiple               â”‚
â”‚   âœ“ Checkpoints     â”‚      throughout      â”‚      experts                â”‚
â”‚   âœ“ Autonomous      â”‚   ğŸ¤– AI planning &   â”‚   ğŸ¤– AI orchestration       â”‚
â”‚                     â”‚      execution       â”‚      & synthesis            â”‚
â”‚                     â”‚   â±ï¸  1-2 hours      â”‚   â±ï¸  2-3 hours             â”‚
â”‚                     â”‚                      â”‚                             â”‚
â”‚                     â”‚   Example:           â”‚   Example:                  â”‚
â”‚                     â”‚   "Research & draft  â”‚   "Create comprehensive     â”‚
â”‚                     â”‚    regulatory        â”‚    market entry strategy"   â”‚
â”‚                     â”‚    submission plan"  â”‚    â†’ AI orchestrates        â”‚
â”‚                     â”‚    â†’ Selected expert â”‚      multiple experts       â”‚
â”‚                     â”‚      works with AI   â”‚      in harmony             â”‚
â”‚                     â”‚                      â”‚                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“Š Mode Comparison Table

| Feature | **Mode 1** | **Mode 2** | **Mode 3** | **Mode 4** |
|---------|------------|------------|------------|------------|
| **Name** | Manual Expert | Automatic Expert | Manual Autonomous | Automatic Autonomous |
| **Icon** | ğŸ¯ Target | âš¡ Lightning | ğŸ¤ Partnership | ğŸ¼ Symphony |
| **Agent Selection** | User selects | AI selects | User selects | AI selects/switches |
| **Conversation** | One-shot | One-shot | Multi-turn | Multi-turn |
| **Knowledge Search** | Agent-specific | Universal | Agent-specific | Hybrid (all domains) |
| **Chat History** | âŒ No | âŒ No | âœ… Yes | âœ… Yes |
| **Workflows** | âŒ No | âŒ No | âœ… Yes | âœ… Yes |
| **Checkpoints** | âŒ No | âŒ No | âœ… Yes | âœ… Yes |
| **Tool Integration** | Basic | Standard | Advanced | Advanced |
| **Time Estimate** | 20-30 sec | 20-30 sec | 1-2 hours | 2-3 hours |
| **Best For** | Known expert + simple query | Unknown expert + simple query | Deep dive with specific expert | Complex multi-domain problems |
| **Backend Enum** | `QUERY_MANUAL` | `QUERY_AUTOMATIC` | `CHAT_MANUAL` | `CHAT_AUTOMATIC` |
| **Frontend ID** | `mode-1-query-automatic` | `mode-2-query-manual` | `mode-3-chat-automatic` | `mode-4-chat-manual` |

---

## ğŸ”„ Current Implementation Flow

### **Step 1: User Interface Selection**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     Ask Expert Interface                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  Toggles:                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚  [ ] Automatic (Agent Selection)                   â”‚        â”‚
â”‚  â”‚      â†‘ OFF = Manual (User selects)                 â”‚        â”‚
â”‚  â”‚      â†“ ON  = Automatic (AI selects)                â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚  [ ] Autonomous (Workflows + Multi-turn)           â”‚        â”‚
â”‚  â”‚      â†‘ OFF = Simple Query                          â”‚        â”‚
â”‚  â”‚      â†“ ON  = Complex Conversation + Workflows      â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚                                                                 â”‚
â”‚  Selected Mode: [Mode Card Display]                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚  ğŸ¯ Mode 1: Manual Expert Selection                â”‚        â”‚
â”‚  â”‚  Choose your specific expert for quick answers     â”‚        â”‚
â”‚  â”‚  â±ï¸  ~20-30 seconds                                 â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### **Step 2: Mode Determination Logic**

```typescript
// Frontend Logic (apps/digital-health-startup/src/features/ask-expert/page.tsx)

const currentMode = useMemo(() => {
  if (!isAutomatic && !isAutonomous) return MODE_DEFS[1];  // Mode 1
  if (isAutomatic && !isAutonomous) return MODE_DEFS[2];   // Mode 2
  if (!isAutomatic && isAutonomous) return MODE_DEFS[3];   // Mode 3
  if (isAutomatic && isAutonomous) return MODE_DEFS[4];    // Mode 4
  return MODE_DEFS[1];
}, [isAutomatic, isAutonomous]);

// Mapping to backend
const modeToOrchestrationType = {
  'mode-1-query-automatic': 'QUERY_MANUAL',      // Mode 1
  'mode-2-query-manual': 'QUERY_AUTOMATIC',      // Mode 2
  'mode-3-chat-automatic': 'CHAT_MANUAL',        // Mode 3
  'mode-4-chat-manual': 'CHAT_AUTOMATIC',        // Mode 4
};
```

### **Step 3: Backend Processing**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  Backend Orchestration Flow                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  1. API Endpoint: /api/ask-expert/orchestrate                  â”‚
â”‚     â†“                                                           â”‚
â”‚  2. Mode Mapper (mode-mapper.ts)                               â”‚
â”‚     â†“                                                           â”‚
â”‚  3. OrchestrationMode Enum Mapping:                            â”‚
â”‚     - Mode 1 â†’ QUERY_MANUAL                                    â”‚
â”‚     - Mode 2 â†’ QUERY_AUTOMATIC                                 â”‚
â”‚     - Mode 3 â†’ CHAT_MANUAL (was CHAT_AUTONOMOUS)               â”‚
â”‚     - Mode 4 â†’ CHAT_AUTOMATIC (was CHAT_AGENT_SELECTION)       â”‚
â”‚     â†“                                                           â”‚
â”‚  4. LangGraph Orchestrator (unified-langgraph-orchestrator.ts) â”‚
â”‚     â†“                                                           â”‚
â”‚  5. Mode-Specific Processing:                                  â”‚
â”‚                                                                 â”‚
â”‚     MODE 1: QUERY_MANUAL                                       â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚     â”‚ â€¢ User-selected agent                       â”‚           â”‚
â”‚     â”‚ â€¢ Agent-specific knowledge search           â”‚           â”‚
â”‚     â”‚ â€¢ Single response                           â”‚           â”‚
â”‚     â”‚ â€¢ No conversation history                   â”‚           â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚                                                                 â”‚
â”‚     MODE 2: QUERY_AUTOMATIC                                    â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚     â”‚ â€¢ AI selects best agent                     â”‚           â”‚
â”‚     â”‚ â€¢ Universal knowledge search                â”‚           â”‚
â”‚     â”‚ â€¢ Single response                           â”‚           â”‚
â”‚     â”‚ â€¢ No conversation history                   â”‚           â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚                                                                 â”‚
â”‚     MODE 3: CHAT_MANUAL                                        â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚     â”‚ â€¢ User-selected agent (consistent)          â”‚           â”‚
â”‚     â”‚ â€¢ Multi-turn conversation                   â”‚           â”‚
â”‚     â”‚ â€¢ Autonomous reasoning & planning           â”‚           â”‚
â”‚     â”‚ â€¢ Workflow support + checkpoints            â”‚           â”‚
â”‚     â”‚ â€¢ Tool chaining & research synthesis        â”‚           â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚                                                                 â”‚
â”‚     MODE 4: CHAT_AUTOMATIC                                     â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚     â”‚ â€¢ AI selects/switches agents dynamically    â”‚           â”‚
â”‚     â”‚ â€¢ Multi-turn conversation                   â”‚           â”‚
â”‚     â”‚ â€¢ Autonomous reasoning & planning           â”‚           â”‚
â”‚     â”‚ â€¢ Workflow support + checkpoints            â”‚           â”‚
â”‚     â”‚ â€¢ Multi-expert orchestration & synthesis    â”‚           â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### **Step 4: Knowledge Search Strategy**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Knowledge Search Flow                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  MODE 1 (QUERY_MANUAL):                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚  Query â†’ Agent-Specific Search                   â”‚         â”‚
â”‚  â”‚  â€¢ Function: search_knowledge_for_agent()        â”‚         â”‚
â”‚  â”‚  â€¢ Searches: Selected agent's domains only       â”‚         â”‚
â”‚  â”‚  â€¢ Max Results: 15                               â”‚         â”‚
â”‚  â”‚  â€¢ Example: Regulatory Expert â†’ FDA, EMA domains â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                                                                 â”‚
â”‚  MODE 2 (QUERY_AUTOMATIC):                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚  Query â†’ Universal Search + Agent Selection      â”‚         â”‚
â”‚  â”‚  â€¢ Function: search_knowledge_by_embedding()     â”‚         â”‚
â”‚  â”‚  â€¢ Searches: ALL domains (null filter)           â”‚         â”‚
â”‚  â”‚  â€¢ Max Results: 10                               â”‚         â”‚
â”‚  â”‚  â€¢ Then: AI selects best matching agent          â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                                                                 â”‚
â”‚  MODE 3 (CHAT_MANUAL):                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚  Multi-turn â†’ Agent-Specific + Context           â”‚         â”‚
â”‚  â”‚  â€¢ Function: search_knowledge_for_agent()        â”‚         â”‚
â”‚  â”‚  â€¢ Searches: Selected agent's domains            â”‚         â”‚
â”‚  â”‚  â€¢ Context: Accumulated conversation history     â”‚         â”‚
â”‚  â”‚  â€¢ Autonomous: Tool chaining enabled             â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                                                                 â”‚
â”‚  MODE 4 (CHAT_AUTOMATIC):                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚  Multi-turn â†’ Hybrid Search + Dynamic Switching  â”‚         â”‚
â”‚  â”‚  â€¢ Function: Hybrid (keyword + semantic)         â”‚         â”‚
â”‚  â”‚  â€¢ Searches: ALL domains with rich metadata      â”‚         â”‚
â”‚  â”‚  â€¢ Context: Multi-expert conversation history    â”‚         â”‚
â”‚  â”‚  â€¢ Autonomous: Multi-expert orchestration        â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### **Step 5: Response Generation**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     Response Generation                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  MODE 1 & 2 (Simple Query):                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚  Knowledge Search                                â”‚         â”‚
â”‚  â”‚         â†“                                        â”‚         â”‚
â”‚  â”‚  LLM Generation (Single Turn)                    â”‚         â”‚
â”‚  â”‚         â†“                                        â”‚         â”‚
â”‚  â”‚  Response with Sources                           â”‚         â”‚
â”‚  â”‚         â†“                                        â”‚         â”‚
â”‚  â”‚  Stream to Frontend                              â”‚         â”‚
â”‚  â”‚  â±ï¸  ~20-30 seconds                              â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                                                                 â”‚
â”‚  MODE 3 & 4 (Autonomous Workflow):                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚  1. Query Analysis & Planning                    â”‚         â”‚
â”‚  â”‚     â€¢ Understand goal                            â”‚         â”‚
â”‚  â”‚     â€¢ Break into steps                           â”‚         â”‚
â”‚  â”‚     â€¢ Identify required tools                    â”‚         â”‚
â”‚  â”‚     â†“                                            â”‚         â”‚
â”‚  â”‚  2. Autonomous Execution Loop                    â”‚         â”‚
â”‚  â”‚     â€¢ Research (RAG search)                      â”‚         â”‚
â”‚  â”‚     â€¢ Tool usage (web search, calculator, etc.)  â”‚         â”‚
â”‚  â”‚     â€¢ Document generation                        â”‚         â”‚
â”‚  â”‚     â€¢ Synthesis                                  â”‚         â”‚
â”‚  â”‚     â†“                                            â”‚         â”‚
â”‚  â”‚  3. Checkpoint (if complex)                      â”‚         â”‚
â”‚  â”‚     â€¢ Present plan/progress                      â”‚         â”‚
â”‚  â”‚     â€¢ Request user approval                      â”‚         â”‚
â”‚  â”‚     â€¢ Continue or adjust                         â”‚         â”‚
â”‚  â”‚     â†“                                            â”‚         â”‚
â”‚  â”‚  4. Final Synthesis                              â”‚         â”‚
â”‚  â”‚     â€¢ Combine all findings                       â”‚         â”‚
â”‚  â”‚     â€¢ Generate comprehensive response            â”‚         â”‚
â”‚  â”‚     â€¢ Include all sources                        â”‚         â”‚
â”‚  â”‚     â†“                                            â”‚         â”‚
â”‚  â”‚  5. Stream to Frontend                           â”‚         â”‚
â”‚  â”‚  â±ï¸  1-3 hours (with checkpoints)                â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ¨ Visual Mode Characteristics

### **Mode 1: Manual Expert Selection** ğŸ¯

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     MODE 1: ğŸ¯                          â”‚
â”‚                Manual Expert Selection                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                         â”‚
â”‚  Theme: Precision & Focus                              â”‚
â”‚  Color: Blue (#3B82F6)                                 â”‚
â”‚  Icon: Target ğŸ¯                                       â”‚
â”‚                                                         â”‚
â”‚  User Journey:                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚ 1. User selects expert manually           â”‚        â”‚
â”‚  â”‚    ğŸ‘¤ â†’ "I need Regulatory Expert"        â”‚        â”‚
â”‚  â”‚         â†“                                 â”‚        â”‚
â”‚  â”‚ 2. User asks specific question            â”‚        â”‚
â”‚  â”‚    ğŸ’¬ "What are FDA 510(k) requirements?" â”‚        â”‚
â”‚  â”‚         â†“                                 â”‚        â”‚
â”‚  â”‚ 3. Agent-specific knowledge search        â”‚        â”‚
â”‚  â”‚    ğŸ“š Searches Regulatory domain only     â”‚        â”‚
â”‚  â”‚         â†“                                 â”‚        â”‚
â”‚  â”‚ 4. Expert provides focused answer         â”‚        â”‚
â”‚  â”‚    ğŸ¯ Single, precise response            â”‚        â”‚
â”‚  â”‚         â†“                                 â”‚        â”‚
â”‚  â”‚ 5. Done (no follow-ups)                   â”‚        â”‚
â”‚  â”‚    âœ… Query complete                      â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚                                                         â”‚
â”‚  Perfect For:                                          â”‚
â”‚  â€¢ "I know which expert I need"                        â”‚
â”‚  â€¢ Quick, focused questions                            â”‚
â”‚  â€¢ Specific expertise required                         â”‚
â”‚  â€¢ Fast turnaround needed                              â”‚
â”‚                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### **Mode 2: Automatic Expert Selection** âš¡

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     MODE 2: âš¡                          â”‚
â”‚              Automatic Expert Selection                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                         â”‚
â”‚  Theme: Intelligence & Discovery                       â”‚
â”‚  Color: Amber (#F59E0B)                                â”‚
â”‚  Icon: Lightning âš¡                                     â”‚
â”‚                                                         â”‚
â”‚  User Journey:                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚ 1. User asks question (no expert selected)â”‚        â”‚
â”‚  â”‚    ğŸ’¬ "Best practices for clinical trials"â”‚        â”‚
â”‚  â”‚         â†“                                 â”‚        â”‚
â”‚  â”‚ 2. AI analyzes query intelligently        â”‚        â”‚
â”‚  â”‚    ğŸ¤– Keywords: clinical, trials, best    â”‚        â”‚
â”‚  â”‚         â†“                                 â”‚        â”‚
â”‚  â”‚ 3. Universal knowledge search             â”‚        â”‚
â”‚  â”‚    ğŸŒ Searches ALL domains                â”‚        â”‚
â”‚  â”‚         â†“                                 â”‚        â”‚
â”‚  â”‚ 4. AI selects best matching expert        â”‚        â”‚
â”‚  â”‚    ğŸ¯ "Clinical Trial Expert (95%)"       â”‚        â”‚
â”‚  â”‚         â†“                                 â”‚        â”‚
â”‚  â”‚ 5. Expert provides comprehensive answer   â”‚        â”‚
â”‚  â”‚    âš¡ Smart, context-aware response       â”‚        â”‚
â”‚  â”‚         â†“                                 â”‚        â”‚
â”‚  â”‚ 6. Done (no follow-ups)                   â”‚        â”‚
â”‚  â”‚    âœ… Query complete                      â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚                                                         â”‚
â”‚  Perfect For:                                          â”‚
â”‚  â€¢ "I don't know which expert to ask"                  â”‚
â”‚  â€¢ Exploratory questions                               â”‚
â”‚  â€¢ Broad topic inquiries                               â”‚
â”‚  â€¢ Let AI find the best expert                         â”‚
â”‚                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### **Mode 3: Manual Autonomous** ğŸ¤

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     MODE 3: ğŸ¤                          â”‚
â”‚                Manual Autonomous                        â”‚
â”‚            (Expert + AI Partnership)                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                         â”‚
â”‚  Theme: Partnership & Consistency                      â”‚
â”‚  Color: Purple (#8B5CF6)                               â”‚
â”‚  Icon: Handshake ğŸ¤                                    â”‚
â”‚                                                         â”‚
â”‚  User Journey:                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚ 1. User selects expert partner            â”‚        â”‚
â”‚  â”‚    ğŸ‘¤ â†’ "Regulatory Expert"               â”‚        â”‚
â”‚  â”‚         â†“                                 â”‚        â”‚
â”‚  â”‚ 2. User describes complex project         â”‚        â”‚
â”‚  â”‚    ğŸ’¬ "Research & draft regulatory plan"  â”‚        â”‚
â”‚  â”‚         â†“                                 â”‚        â”‚
â”‚  â”‚ 3. AI creates workflow plan               â”‚        â”‚
â”‚  â”‚    ğŸ¤– Phase 1: Classification             â”‚        â”‚
â”‚  â”‚       Phase 2: Strategy Development       â”‚        â”‚
â”‚  â”‚       Phase 3: Document Creation          â”‚        â”‚
â”‚  â”‚         â†“                                 â”‚        â”‚
â”‚  â”‚ 4. Checkpoint: User approves plan         â”‚        â”‚
â”‚  â”‚    âœ… "Looks good, proceed"               â”‚        â”‚
â”‚  â”‚         â†“                                 â”‚        â”‚
â”‚  â”‚ 5. Expert + AI collaborate               â”‚        â”‚
â”‚  â”‚    ğŸ¤ Expert knowledge + AI execution     â”‚        â”‚
â”‚  â”‚       Multi-turn conversation             â”‚        â”‚
â”‚  â”‚       Tool chaining & research            â”‚        â”‚
â”‚  â”‚         â†“                                 â”‚        â”‚
â”‚  â”‚ 6. Progress checkpoints                   â”‚        â”‚
â”‚  â”‚    ğŸ“Š User reviews, provides guidance     â”‚        â”‚
â”‚  â”‚         â†“                                 â”‚        â”‚
â”‚  â”‚ 7. Final deliverable                      â”‚        â”‚
â”‚  â”‚    ğŸ“„ Complete regulatory submission plan â”‚        â”‚
â”‚  â”‚         â†“                                 â”‚        â”‚
â”‚  â”‚ 8. Follow-up conversations possible       â”‚        â”‚
â”‚  â”‚    ğŸ’¬ "How about CE marking?"             â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚                                                         â”‚
â”‚  Perfect For:                                          â”‚
â”‚  â€¢ "I need a specific expert for deep work"            â”‚
â”‚  â€¢ Complex multi-step projects                         â”‚
â”‚  â€¢ Consistent expert voice throughout                  â”‚
â”‚  â€¢ Workflow planning & execution                       â”‚
â”‚  â€¢ Document generation & synthesis                     â”‚
â”‚                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### **Mode 4: Automatic Autonomous** ğŸ¼

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     MODE 4: ğŸ¼                          â”‚
â”‚              Automatic Autonomous                       â”‚
â”‚              (Expert Orchestra)                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                         â”‚
â”‚  Theme: Orchestration & Harmony                        â”‚
â”‚  Color: Green (#10B981)                                â”‚
â”‚  Icon: Musical Note ğŸ¼                                 â”‚
â”‚                                                         â”‚
â”‚  User Journey:                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚ 1. User describes ambitious project       â”‚        â”‚
â”‚  â”‚    ğŸ’¬ "Create comprehensive market entry  â”‚        â”‚
â”‚  â”‚        strategy for biotech product"      â”‚        â”‚
â”‚  â”‚         â†“                                 â”‚        â”‚
â”‚  â”‚ 2. AI analyzes complexity                 â”‚        â”‚
â”‚  â”‚    ğŸ¤– Requires: Regulatory + Market +     â”‚        â”‚
â”‚  â”‚       Clinical + Business experts         â”‚        â”‚
â”‚  â”‚         â†“                                 â”‚        â”‚
â”‚  â”‚ 3. AI creates orchestrated workflow       â”‚        â”‚
â”‚  â”‚    ğŸ¼ Movement 1: Regulatory Analysis     â”‚        â”‚
â”‚  â”‚       Movement 2: Market Research         â”‚        â”‚
â”‚  â”‚       Movement 3: Clinical Feasibility    â”‚        â”‚
â”‚  â”‚       Movement 4: Business Strategy       â”‚        â”‚
â”‚  â”‚       Movement 5: Synthesis               â”‚        â”‚
â”‚  â”‚         â†“                                 â”‚        â”‚
â”‚  â”‚ 4. Checkpoint: User approves symphony     â”‚        â”‚
â”‚  â”‚    âœ… "Perfect, let's begin"              â”‚        â”‚
â”‚  â”‚         â†“                                 â”‚        â”‚
â”‚  â”‚ 5. AI conducts expert orchestra           â”‚        â”‚
â”‚  â”‚    ğŸ¼ Regulatory Expert (lead)            â”‚        â”‚
â”‚  â”‚       â†’ Market Expert (harmony)           â”‚        â”‚
â”‚  â”‚       â†’ Clinical Expert (solo)            â”‚        â”‚
â”‚  â”‚       â†’ Business Expert (finale)          â”‚        â”‚
â”‚  â”‚         â†“                                 â”‚        â”‚
â”‚  â”‚ 6. Seamless expert transitions            â”‚        â”‚
â”‚  â”‚    ğŸ”„ Context preserved across experts    â”‚        â”‚
â”‚  â”‚       Each expert contributes their part  â”‚        â”‚
â”‚  â”‚         â†“                                 â”‚        â”‚
â”‚  â”‚ 7. Periodic checkpoints                   â”‚        â”‚
â”‚  â”‚    ğŸ“Š "Movement 1 complete. Continue?"    â”‚        â”‚
â”‚  â”‚         â†“                                 â”‚        â”‚
â”‚  â”‚ 8. Grand synthesis                        â”‚        â”‚
â”‚  â”‚    ğŸ‰ AI combines all expert insights     â”‚        â”‚
â”‚  â”‚       into comprehensive strategy         â”‚        â”‚
â”‚  â”‚         â†“                                 â”‚        â”‚
â”‚  â”‚ 9. Comprehensive deliverable              â”‚        â”‚
â”‚  â”‚    ğŸ“„ 85-page strategy with attribution   â”‚        â”‚
â”‚  â”‚       Each expert's contribution marked   â”‚        â”‚
â”‚  â”‚         â†“                                 â”‚        â”‚
â”‚  â”‚ 10. Multi-expert follow-ups possible      â”‚        â”‚
â”‚  â”‚    ğŸ’¬ AI switches experts as needed       â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚                                                         â”‚
â”‚  Perfect For:                                          â”‚
â”‚  â€¢ "I need the best minds working together"            â”‚
â”‚  â€¢ Complex multi-domain challenges                     â”‚
â”‚  â€¢ Comprehensive solutions required                    â”‚
â”‚  â€¢ Multiple perspectives needed                        â”‚
â”‚  â€¢ AI-orchestrated collaboration                       â”‚
â”‚                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”€ Mode Selection Decision Tree

```
START: What kind of help do you need?
â”‚
â”œâ”€ "I have a QUICK QUESTION"
â”‚  â”‚
â”‚  â”œâ”€ "I KNOW which expert to ask"
â”‚  â”‚  â””â”€â†’ ğŸ¯ MODE 1: Manual Expert Selection
â”‚  â”‚      â€¢ Select your expert
â”‚  â”‚      â€¢ Get focused answer
â”‚  â”‚      â€¢ Done in 20-30 seconds
â”‚  â”‚
â”‚  â””â”€ "I DON'T KNOW which expert to ask"
â”‚     â””â”€â†’ âš¡ MODE 2: Automatic Expert Selection
â”‚         â€¢ AI finds best expert
â”‚         â€¢ Get smart answer
â”‚         â€¢ Done in 20-30 seconds
â”‚
â””â”€ "I have a COMPLEX PROJECT / Need WORKFLOW"
   â”‚
   â”œâ”€ "I want ONE SPECIFIC EXPERT throughout"
   â”‚  â””â”€â†’ ğŸ¤ MODE 3: Manual Autonomous
   â”‚      â€¢ Select your expert partner
   â”‚      â€¢ AI plans & executes with that expert
   â”‚      â€¢ Consistent expert voice
   â”‚      â€¢ Checkpoints for approval
   â”‚      â€¢ 1-2 hour workflows
   â”‚
   â””â”€ "I want the BEST EXPERTS working together"
      â””â”€â†’ ğŸ¼ MODE 4: Automatic Autonomous
          â€¢ AI orchestrates multiple experts
          â€¢ Seamless expert transitions
          â€¢ Multi-perspective synthesis
          â€¢ Checkpoints for approval
          â€¢ 2-3 hour workflows
```

---

## ğŸ“‹ Quick Selection Guide

### **Choose Mode 1 (ğŸ¯) When:**
- âœ… You know exactly which expert you need
- âœ… You have a specific, focused question
- âœ… You want a fast answer (20-30 seconds)
- âœ… No follow-up conversation needed
- âŒ DON'T choose if: You're unsure which expert or need multi-step workflow

### **Choose Mode 2 (âš¡) When:**
- âœ… You don't know which expert to ask
- âœ… You have a quick question
- âœ… You want AI to find the best expert
- âœ… You trust AI's expert selection
- âŒ DON'T choose if: You need a specific expert or multi-step workflow

### **Choose Mode 3 (ğŸ¤) When:**
- âœ… You need a specific expert for deep work
- âœ… You want consistent expert voice throughout
- âœ… You have a complex project with multiple steps
- âœ… You need AI planning & execution assistance
- âœ… You want control via checkpoints
- âŒ DON'T choose if: You need multiple expert perspectives

### **Choose Mode 4 (ğŸ¼) When:**
- âœ… You have a complex, multi-domain challenge
- âœ… You need multiple expert perspectives
- âœ… You want AI to orchestrate expert collaboration
- âœ… You need comprehensive, synthesized solutions
- âœ… You want AI to handle expert transitions
- âŒ DON'T choose if: You need simple answers or specific expert consistency

---

## ğŸ—ï¸ Technical Architecture

### **Frontend Components**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            Frontend Architecture                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                         â”‚
â”‚  page.tsx (Main Ask Expert Page)                       â”‚
â”‚  â”œâ”€ EnhancedModeSelector (Mode selection UI)           â”‚
â”‚  â”œâ”€ AgentSelector (Modes 1 & 3)                        â”‚
â”‚  â”œâ”€ PromptInput (Query input)                          â”‚
â”‚  â”œâ”€ ResponseDisplay (Streaming responses)              â”‚
â”‚  â””â”€ WorkflowCheckpoints (Modes 3 & 4)                  â”‚
â”‚                                                         â”‚
â”‚  State Management:                                     â”‚
â”‚  â”œâ”€ isAutomatic: boolean                               â”‚
â”‚  â”œâ”€ isAutonomous: boolean                              â”‚
â”‚  â”œâ”€ selectedAgent: Agent | null                        â”‚
â”‚  â”œâ”€ conversationHistory: Message[]                     â”‚
â”‚  â””â”€ checkpointStatus: CheckpointState                  â”‚
â”‚                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### **Backend Services**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            Backend Architecture                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                         â”‚
â”‚  API Route: /api/ask-expert/orchestrate                â”‚
â”‚     â†“                                                   â”‚
â”‚  mode-mapper.ts (Mode ID â†’ Enum mapping)               â”‚
â”‚     â†“                                                   â”‚
â”‚  unified-langgraph-orchestrator.ts                     â”‚
â”‚  â”œâ”€ Mode 1: QUERY_MANUAL                               â”‚
â”‚  â”‚   â””â”€ Single agent, one-shot                         â”‚
â”‚  â”œâ”€ Mode 2: QUERY_AUTOMATIC                            â”‚
â”‚  â”‚   â””â”€ Agent selection, one-shot                      â”‚
â”‚  â”œâ”€ Mode 3: CHAT_MANUAL                                â”‚
â”‚  â”‚   â””â”€ Single agent, autonomous workflow              â”‚
â”‚  â””â”€ Mode 4: CHAT_AUTOMATIC                             â”‚
â”‚      â””â”€ Multi-agent, autonomous orchestration          â”‚
â”‚                                                         â”‚
â”‚  Supporting Services:                                  â”‚
â”‚  â”œâ”€ unified-rag-service.ts (Knowledge search)          â”‚
â”‚  â”œâ”€ agent-service.ts (Agent management)                â”‚
â”‚  â”œâ”€ tool-registry.ts (Tool integration)                â”‚
â”‚  â””â”€ checkpoint-service.ts (Workflow checkpoints)       â”‚
â”‚                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“ Implementation Status

### **Current Status: âœ… All 4 Modes Implemented**

| Component | Status | Notes |
|-----------|--------|-------|
| Frontend UI | âœ… Complete | 2-toggle system working |
| Mode Selection | âœ… Complete | All 4 modes selectable |
| Mode 1 Implementation | âœ… Complete | QUERY_MANUAL working |
| Mode 2 Implementation | âœ… Complete | QUERY_AUTOMATIC working |
| Mode 3 Implementation | âœ… Complete | CHAT_MANUAL with workflows |
| Mode 4 Implementation | âœ… Complete | CHAT_AUTOMATIC with orchestration |
| Knowledge Search | âœ… Complete | All search strategies implemented |
| Checkpoint System | âœ… Complete | Human-in-the-loop for Modes 3 & 4 |
| Tool Integration | âœ… Complete | Advanced tools for Modes 3 & 4 |

### **Verified Functionality:**
- âœ… Mode toggling and selection
- âœ… Agent selection (Modes 1 & 3)
- âœ… Knowledge search strategies
- âœ… Streaming responses
- âœ… Conversation history (Modes 3 & 4)
- âœ… Workflow planning (Modes 3 & 4)
- âœ… Checkpoints (Modes 3 & 4)
- âœ… Multi-expert orchestration (Mode 4)

---

## ğŸ¯ Usage Examples

### **Example 1: Mode 1 (Quick Expert Query)**

```
User: Selects "Regulatory Expert"
Query: "What are the key requirements for FDA 510(k) submission?"
Time: ~25 seconds
Result: Focused regulatory answer with FDA-specific sources
```

### **Example 2: Mode 2 (Smart Discovery)**

```
User: No expert selected
Query: "What are best practices for Phase 3 clinical trials?"
AI: Analyzes â†’ Selects "Clinical Trial Expert" (93% confidence)
Time: ~30 seconds
Result: Comprehensive clinical trial answer
```

### **Example 3: Mode 3 (Expert Partnership)**

```
User: Selects "Regulatory Expert"
Query: "Research and draft a complete regulatory submission strategy"
AI: Creates 3-phase workflow
  Phase 1: Device Classification (15 min)
  Phase 2: Regulatory Pathway Analysis (25 min)
  Phase 3: Submission Document Draft (45 min)
User: Approves plan at checkpoint
Execution: Expert + AI collaborate with tool chaining
Result: Comprehensive regulatory strategy document
Time: ~1.5 hours
```

### **Example 4: Mode 4 (Expert Orchestra)**

```
User: No expert selected
Query: "Create comprehensive market entry strategy for new biotech"
AI: Analyzes complexity â†’ Requires 4 experts
  Movement 1: Regulatory Expert (regulatory landscape)
  Movement 2: Market Access Expert (market analysis)
  Movement 3: Clinical Expert (clinical feasibility)
  Movement 4: Business Expert (financial modeling)
User: Approves orchestration at checkpoint
Execution: AI conducts symphony, seamless expert transitions
Synthesis: AI combines all perspectives into unified strategy
Result: 85-page comprehensive strategy with expert attribution
Time: ~2.5 hours
```

---

## ğŸ”— Related Documentation

- **Implementation Details:** `apps/digital-health-startup/src/features/ask-expert/utils/mode-mapper.ts`
- **Mode PRDs:**
  - `MODE1_HELPER_PRD.md` - Manual Expert Selection
  - `MODE2_HELPER_PRD.md` - Automatic Expert Selection
  - `MODE3_HELPER_PRD.md` - Manual Autonomous
  - `MODE4_HELPER_PRD.md` - Automatic Autonomous
- **User Journeys:**
  - `MODE1_USER_JOURNEY.md`
  - `MODE2_USER_JOURNEY.md`
  - `MODE3_USER_JOURNEY.md`
  - `MODE4_USER_JOURNEY.md`
- **Integration Status:** `docs/4_MODE_INTEGRATION_COMPLETE.md`

---

**Document Version:** 1.0  
**Last Updated:** November 6, 2025  
**Status:** Complete & Current






